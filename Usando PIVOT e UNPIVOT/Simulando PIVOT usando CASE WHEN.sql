-- Criando e inserindo dados na tabela
DECLARE @TBL_VENDAS AS TABLE
(
    ANO SMALLINT,
    PRODUTO VARCHAR(100),
    TOTAL_VENDA DECIMAL(10,2)
);

INSERT INTO
	@TBL_VENDAS (ANO, PRODUTO, TOTAL_VENDA)
VALUES
	(2022, 'Notebook', 15000.00),
	(2022, 'Smartphone', 22000.00),
	(2022, 'Tablet', 7000.00),
	(2022, 'Headset', 4000.00),
	(2023, 'Notebook', 18000.00),
	(2023, 'Smartphone', 25000.00),
	(2023, 'Tablet', 9000.00),
	(2023, 'Headset', 5000.00),
	(2024, 'Notebook', 20000.00),
	(2024, 'Smartphone', 30000.00),
	(2024, 'Tablet', 9500.00),
	(2024, 'Headset', 6000.00);

-- Exemplo
SELECT
	PRODUTO,
	SUM(CASE WHEN ANO = 2022 THEN TOTAL_VENDA ELSE 0 END) AS [TOTAL_VENDAS_2022],
	SUM(CASE WHEN ANO = 2023 THEN TOTAL_VENDA ELSE 0 END) AS [TOTAL_VENDAS_2023],
	SUM(CASE WHEN ANO = 2024 THEN TOTAL_VENDA ELSE 0 END) AS [TOTAL_VENDAS_2024]
FROM
	@TBL_VENDAS
GROUP BY
	PRODUTO
ORDER BY
	PRODUTO;